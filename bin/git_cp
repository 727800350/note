#!/bin/bash

## set -x

dir=`pwd`
cd ${dir}

git status > status.info

flag="clean"

cat status.info | grep "# Untracked files:" 1>/dev/null
if [ $? -eq 0 ]
then
	flag="untrack"
fi

cat status.info | grep "ahead of" 1>/dev/null
if [ $? -eq 0 ]
then
	flag="ahead"
fi

cat status.info | grep "modified:" 1>/dev/null
if [ $? -eq 0 ]
then
	flag="modified"
fi

cat status.info | grep "to be committed" 1>/dev/null
if [ $? -eq 0 ]
then
	flag="commit"
fi

echo "repo `git_where` status = ${flag}"
case ${flag} in
	"clean")
		echo "repo is clean"
	;;
	"untrack")
		echo "there are untracked files"
	;;
	"ahead")
		git push -v origin `git_where`
	;;
	"modified")
		git commit -a -m "$@"
		git push -v origin `git_where`
	;;
	"commit")
		git commit -m "$@"
		git push -v origin `git_where`
	;;
	*)
		echo "${flag} not supported"
		exit 1
esac

rm status.info

exit 0

