数据库的乐观锁和悲观锁是什么?

数据库管理系统(DBMS)中的并发控制的任务是确保在多个事务同时存取数据库中同一数据时不破坏事务的隔离性和统一性以及数据库的统一性. 

乐观并发控制(乐观锁)和悲观并发控制(悲观锁)是并发控制主要采用的技术手段.

- 悲观锁: 假定会发生并发冲突,屏蔽一切可能违反数据完整性的操作
	- 使用 `select .... for update` 会把数据给锁住,不过我们需要注意一些锁的级别,MySQL InnoDB默认行级锁.
		行级锁都是基于索引的, 如果一条SQL语句用不到索引是不会使用行级锁的,会使用表级锁把整张表锁住,这点需要注意.
- 乐观锁: 假设不会发生并发冲突,只在提交操作时检查是否违反数据完整性.
	- 一般的实现乐观锁的方式就是记录数据版本.
		数据版本,为数据增加的一个版本标识.当读取数据时,将版本标识的值一同读出,数据每更新一次,同时对版本标识进行更新.
		当我们提交更新的时候,判断数据库表对应记录的当前版本信息与第一次取出来的版本标识进行比对,如果数据库表当前版本号与第一次取出来的版本标识值相等,则予以更新,否则认为是过期数据.

简单说一说drop,delete与truncate的区别

- drop: 删除整个表, 包括表的结构
- truncate: 保留表而删除所有数据的时候用
- truncate, drop是DDL(Data Definition Language), 操作立即生效,原数据不放到rollback segment中,不能回滚. 操作不触发trigger.   
- delete: 删除部分数据行,并且带上where子句. delete语句是DML(Data Manipulation Language),这个操作会放到rollback segement中,事务提交之后才生效; 如果有相应的trigger,执行的时候将被触发. 
- 速度, 一般来说: drop > truncate > delete 

