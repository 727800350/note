% !Mode:: "TeX:UTF-8"
\documentclass{article}
\input{../public/package}
\input{../public/article}
\input{../public/math}
\begin{document}
\title{随机过程}
\author{Common}
\maketitle
%% \newpage
\tableofcontents
\newpage

\section{General introduction}
一族无穷多个,相互有关的随机变量,这就是随机过程

在概率论中,我们研究了用一个或有限多个随机变量来描述的随机现象.
然而对有些现象还需要研究它的发展变化过程,这类现象若仅用一个或有限多个随机变量描述它,就不能揭示其全部统计规律性,于是出现了随机过程的理论.
\begin{example}
用$X(t)$表示在每天的$t$时刻$t \in [a, b]$的气温.对固定的$t$,
表示一个随机变量,当取遍$t \in [a,b ]$时,得到一族随机变量$\{X(t); t \in T\}$
\end{example}

$X(\cdot, \omega)$ 是一个关于参数$t \in T$ 的函数, 通常称为样本函数,或称随机过程的一次实现.\\
所有样本函数的集合确定一随机过程

随机过程$\{X(t);t \in T\}$ 可能取值的全体所构成的集合称为此随机过程的状态空间,记作$S$.\\
$S$中的元素称为状态.状态空间可以由复数,实数或更一般的抽象空间构成.

\begin{example}
抛掷一枚硬币,样本空间为$\Omega = \{T, H\}$ ,借此定义
$$
X(t)=
\left\{
  \begin{array}{ll}
   \cos(\pi t) , & \hbox{Head;} \\
    2t, & \hbox{Tail.}
  \end{array}
\right.
$$
其中$P(H)=P(T)=1/2$, 则$\{X(t), t \in (-\infty, \infty)\}$是一随机过程.

样本函数为$\cos(\pi t)$和$2t$, 由于样本函数的取值:
$$\cos(\pi t)\ \in [-1,1], 2t \in (-\infty, \infty)$$
所以状态空间
$$S=(-\infty, \infty)$$
\end{example}

\section{Metrics}
\subsection{相关函数和协方差函数}
\href{http://202.117.122.42:9001/xhxt/xhyxt/xuexi/chart9/c\_9\_3\_2\_001.htm}{相关函数和协方差函数}

相关性是指两个随机变量之间的线性关系,不相关只是说明它们之间不具有线性关系,但是可以有别的关系,所以不一定相互独立.\\
如果两个随机变量独立,就是说它们之间没有任何关系,自然也不会有线性关系,所以它们不相关.\\
反过来说如果两个随机变量相关,也就是说它们之间有线性关系,自然不独立.

\href{http://www.cppblog.com/sosi/archive/2010/09/20/127151.html}{随机变量相关与独立的关系}

\textbf{自相关函数(Autocorrelation function)}\\
自相关函数是描述随机信号$X(k)$在任意两个不同时刻$k_1,k_2$的取值$X(k_1) $和$X(k_2) $之间的相关程度
$$
R_X(k_1, k_2)
= E[X(k_1) X(k_2)]
= \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} x_1 x_2 f(x_1, x_2, k_1, k_2)dx_1 dx_2
$$
$f(x_1, x_2, k_1, k_2)$ 为$X$在$k_1$时刻取$x_1$, $k_2$时刻取$x_2$的概率密度函数.

\textbf{自协方差函数(Autocovariance function)}\\
同理,自协方差函数是描述随机信号$X(k)$在任意两个不同时刻k1,k2的取值\textbf{起伏变化之间的相关程度}
$$ C_X(k_1,k_2) = E[(X(k_1) - \mu_X(k_1)) (X(k_2) - \mu_X(k_2))] $$
$\mu_X(k_1)$ 为$X(k)$在$k_1$时刻的预期值, 然后$(X(k_1) - \mu_X(k_1))$就为$X(k)$在$k_1$时刻的起伏变化.

$$
\begin{aligned}
C_X(k_1,k_2)
& = E[(X(k_1) - \mu_X(k_1)) (X(k_2) - \mu_X(k_2))] \\
& = E[(X(k_1) X(k_2) - \mu_X(k_1)(X(k_2) - X(k_1)\mu_X(k_2) + \mu_X(k_1) \mu_X(k_2)] \\
& = E[(X(k_1) X(k_2)] - \mu_X(k_1)E[(X(k_2)] - E[X(k_1)]\mu_X(k_2) + \mu_X(k_1) \mu_X(k_2) \\
& = E[(X(k_1) X(k_2)] - \mu_X(k_1) \mu_X(k_2) - \mu_X(k_1) \mu_X(k_2) + \mu_X(k_1) \mu_X(k_2) \\
& = E[(X(k_1) X(k_2)] - \mu_X(k_1) \mu_X(k_2)\\
& = R_X(k_1, k_2) - \mu_X(k_1) \mu_X(k_2)
\end{aligned}
$$
\textbf{互相关函数(Cross correlation function)}\\
类似于连续随机信号的情况,两个随机序列 之间的相关程度由互相关函数和互协方差函数描述.两个随机序列的互相关函数为
$$ R_{XY}(k_1, k_2) = E[X(k_1) Y(k_2)]$$

\textbf{互协方差函数(Cross covariance function)}\\
两个随机序列 之间的互协方差函数为
$$ C_{XY}(k_1,k_2) = E[(X(k_1) - \mu_X(k_1)) (Y(k_2) - \mu_Y(k_2))] = R_{XY}(k_1,k_2) - \mu_X(k_1) \mu_Y(k_2) $$

如果两个随机过程 $\{X(t); t \in T\}$ 和 $\{Y(t); t \in T\}$,
对于任意的两个参数$s,t \in T$, 有 $$ C_{XY}(s,t) = 0 $$
则称随机过程 $\{X(t); t \in T\}$ 和 $\{Y(t); t \in T\}$是统计不相关的或不相关的.\\
因为若随机过程 $\{X(t); t \in T\}$ 和 $\{Y(t); t \in T\}$是不相关的, 那么
$$ E[X(k_1) Y(k_2)] = E[X(k_1)] E[Y(k_2)] $$
即
$$R_X(k_1, k_2) = \mu_X(k_1) \mu_X(k_2)$$

\subsection{Spectral density}
The (power) spectrum of a time-series $x(t)$(often, in electrical engineering applications, the voltage amplitude of a signal), 
describes how the variance of the data $x(t)$ is distributed over the \textbf{frequency components} into which $x(t)$ may be decomposed.

This distribution of the variance may be described either by a measure $\mu $or by a statistical cumulative distribution function 
$S(f)=$the power contributed by frequencies from $0$ up to $f$. \\
Then $S$ is called the \textbf{spectral distribution function of $x$}.

Provided $S$ is an absolutely continuous function, then there exists a \textbf{spectral density function(PSD)} $S'$. \\
In this case, the data or signal is said to possess an absolutely continuous spectrum. 

The nature of the spectrum of a function $x$ gives useful information about the nature of $x$, for example, whether it is periodic or not. 
The study of the power spectrum is a kind of generalisation of Fourier analysis and applies to functions which do not possess Fourier transforms.

\section{平稳过程}
有一类重要的随机过程,它处于某种概率平衡状态其主要性质只与变量$X(t)$之间的时间间隔有关而与我们考查的起始点无关, 
或者说,整个随机过程的统计特性不随时间的推移而变化.这类过程叫做平稳过程.

\begin{example}
例如,飞机在某一水平高度h上飞行时,由于受到气流的影响,
实际飞行高度H(t)总是在理论设计高度h水平上下随机波动,此时飞机的实际飞行高度H(t)是一个随机过程,
显然此过程可看作不随机推移面变化的过程,这个随机过程,我们把它看作是平衡的随机过程
\end{example}

此外当我们知道一个随机过程是平稳过程时,它应不随时间的推移而变幻无常.
例如当我们要测定一个电阻的热噪声的统计特性,由于它是平稳过程,因而我们在任何时间进行测试都能得到相同的结果

\section{高斯随机过程}
\href{http://www.cnblogs.com/tornadomeet/archive/2013/06/14/3135380.html}{机器学习\&数据挖掘笔记\_10(高斯过程简单理解)}
\begin{definition}
For any set $S$, a Gaussian process(GP) on $S$ is a set of r.v.s 
$(Z_t) = (Z_t: t \in S)$ s.t.\\
$\forall n \in N, \forall \vector{t} \in S, (Z_{t_1}, Z_{t_2}, \ldots, Z_{t_n})$ is mutivariant Gaussian
\end{definition}
$(Z_{t_1}, Z_{t_2}, \ldots, Z_{t_n})$ is a finite dimensional distribution.

\begin{example}
		$S = \{1,2,\ldots, d\}$, $(Z_t) = (Z_{t_1}, Z_{t_2}, \ldots, Z_{t_d})$ is mutivariant Gaussian (a trivial example)
\end{example}

\begin{example}
\textbf{random lines}\\
$S = \R, Z_t = t W, W \in \R \obey N(0,1)$
$$
AW = 
\begin{pmatrix}
t_1 \\
\vdots \\
t_n \\
\end{pmatrix}
W
=
\begin{pmatrix}
t_1 W \\
\vdots \\
t_n W\\
\end{pmatrix}
=
\begin{pmatrix}
Z_{t_1} \\
\vdots \\
Z_{t_n} \\
\end{pmatrix}
\ Gaussian
$$
$t\ Z_t$的图像是一个由经过原点的任意条直线组成的图形
\end{example}

\begin{theorem}
\textbf{Existence of Gaussian Process}\\
For any set $S$, any mean fn: $\mu: S \rightarrow \R$ and any covariance fn: $k: S \times S \rightarrow  \R$, there exists a $(Z_t)$ on $S$, s.t.
$$EZ_t = \mu(t),\ Cov(Z_s, Z_t) = k(s,t)\ \forall s,t \in S$$
\end{theorem}

\begin{example}
\textbf{各种GP的示例}

$\alpha, \beta > 0$\\
使用$t$表示时间, 也就是一个运动过程, $x,y$表示空间位置
\begin{enumerate}
\item  Random lines: $S=\R, \mu(x) = 0, k(x,y) = x^T y$; % Linear 
\item  Random planes: $S=\R^d, \mu(x) = 0, k(x,y) = x^T y$; % Linear 
\item  Std Brownian motion: $S=[0,\infty), \mu(t) = 0,  k(s,t) = \alpha \min(x,y)$
\item  Squared exponential $S = \R, \mu(x) = 0, k(x,y) = exp(- \alpha |x-y|^2)$ 
\item  Squared exponential $S = \R^d, \mu(x) = 0, k(x,y) = exp(- \alpha \norm{x-y}^2)$
\item  Ornstein-Uhlenbsk: $S=[0,\infty), \mu(t) = 0, k(x,y)  = exp(- \alpha |x-y|)$ like Brownian motion
\item  Periodic: $S = \R, \mu(x) = 0, k(x,y)  = exp(- \alpha sin(\beta \pi (x-y))^2)$ 
\item  Symmetric GP(关于直线$x=0$对称): $S =\R, \mu(x) = 0, k(x,y)  = exp(-\alpha \min(|x-y|, |x+y|)^2)$
\end{enumerate}
\href{../../demo/math/gaussian_1d.m}{Guassian 1D matlab 模拟程序}
\end{example}

看\href{http://i.imgbox.com/6XtDDnQs.png}{2D GP俯视图}, 和我们看天气预报的时候看到的weather map, 比如temperature, 非常像, 这也是为什么GP在气象, 地理中应用广泛的一个直观感受.\\
前面用到的kernel 函数, 基本上都是$x,y$ 相距很近时, exponential 非常大, 也就意味着相关性非常大, 
正如图\href{http://i.imgbox.com/1OsWR7cU.png}{2D GP}中看到的, 相距很近的点, 颜色非常接近, 而相距很远的点, 颜色差别非常大, 基本上没有关联.

若随机过程$X(t)$的任意$n$维概率分布都是高斯分布的,则称它为高斯过程或正态过程

高斯过程$X(t)$的$n$维概率密度有:
$$
f_X(x_1, x_2, \ldots, x_n; t_1, t_2, \ldots, t_n) = 
\frac{1}{(2\pi)^{n/2} |C|^{1/2}} \exp[- \frac{(X - M_X)^T C^{-1} (X - M_X)}{2}]
$$

均值矢量
$$ M_X = [E[X(t_1)] E[X(t_2)] \ldots E[X(t_n)]]^T = [m_X(t_1) m_X(t_2) \ldots m_X(t_n)]^T $$

C 为协方差矩阵, 其每个元素是各个向量元素之间的协方差.这是从标量随机变量到高维度随机向量的自然推广.\\
协方差矩阵被定义的第i,j项是如下:
$$ C_{ij} = \mathrm{cov}(X_i, X_j) = \mathrm{E}\begin{bmatrix} (X_i - \mu_i)(X_j - \mu_j) \end{bmatrix} $$

即:
$$
C=\mathrm{E}
\left[
 \left(
 \textbf{X} - \mathrm{E}[\textbf{X}]
 \right)
 \left(
 \textbf{X} - \mathrm{E}[\textbf{X}]
 \right)^\top
\right]
$$

从式中可以看出,高斯随机过程的n维概率分布完全由均值矢量$M_X$与协方差矩阵$C$所确定

\textbf{互不相关 $\leftrightarrow$ 互相独立}
\begin{theorem}
如果高斯过程$X(t)$在$n$个不同时刻$t_1, t_2, \ldots, t_n$的状态$X(t_1), X(t_2), \ldots, X(t_n)$两两互不相关,即
$$
C_{ij} = C_X(t_i, t_j) = E[(X(t_i) - m_i)(X(t_j - m_j))] = 0, (i \neq j)
$$
则这些状态之间也是互相独立的.
\end{theorem}
\begin{proof}
由于$C_{ij} = 0$, 则, 
$$ C = diag{\sigma^2(t_1), \sigma^2(t_2), \ldots, \sigma^2(t_n)}$$
代入定义, 并展开得到:
$$
\begin{aligned}
& f_X(x_1, x_2, \ldots, x_n; t_1, t_2, \ldots, t_n) \\
& = \frac{1}{(2\pi)^{n/2} \sigma(t_1) \cdots \sigma(t_n)} \exp[-\frac{1}{2} \sum_{i=1}^n \frac{(x_i - m(t_i))^2}{\sigma^2(t_i)}]\\
& = \prod_{i=1}^n \frac{1}{(2\pi)^{n/2} \sigma(t_i)} \exp[-\frac{(x_i - m(t_i))^2}{2 \sigma^2(t_i)}]\\
& = f_X(x_1; t_1) f_X(x_2; t_2) \cdots f_X(x_n; t_n)\\
\end{aligned}
$$
由互不相关$\rightarrow$互相独立, 反之, 显然成立
\end{proof}

\textbf{宽平稳$\leftrightarrow$严平稳}
\begin{theorem}
\end{theorem}

\section{排队模型}
M/M/1排队模型(M/M/1 model)是一种单一服务器(single-server)的(排队模型),可用作模拟不少系统的运作.
依据开恩特罗符号必须有下列的条件:
\begin{itemize}
\item 到达时间服从泊松分布(Poisson distribution)
\item 服务时间是指数分布(exponentially distributed)
\item 只有一部服务器(server)
\item 队列长度无限制
\item 可加入队列的人数为无限
\end{itemize}
\href{http://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Mm1\_queue.svg/292px-Mm1\_queue.svg.png}{Mm1}

这种模型是一种出生-死亡过程,此随机过程中的每一个状态代表模型中人数的数目.因为模型的队列长度无限且参与人数亦无限,故此状态数目亦为无限.
例如状态0表示模型闲置,状态1表示模型有一人在接受服务,状态2表示模型有二人(一人正接受服务,一人在等候),
如此类推. 此模型中,出生率(即加入队列的速率)$\lambda$ 在各状态中均相同,死亡率(即完成服务离开队列的速率)$\mu$亦在各状态中相同(除了状态0,因其不可能有人离开队列).

故此,在任何状态下,只有两种事情可能发生:
\begin{itemize}
\item 有人加入队列.如果模型在状态k,它会以速率$\lambda$ 进入状态$k + 1$
\item 有人离开队列.如果模型在状态k(k不等于0),它会以速率$\mu$进入状态$k ? 1$
\end{itemize}

\href{http://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/MM1\_queue\_state\_space.svg/605px-MM1\_queue\_state\_space.svg.png}{State space transmission}

由此可见,模型的隐定条件为$\lambda < \mu$.如果死亡率小于出生率,则队列中的平均人数为无限大,故此这种系统没有平衡点.

此模型中有几项数值常被测量,例如:
\begin{itemize}
\item 一人在系统中的平均逗留时间
\item 一人在接受服务前的平均等候时间
\item 整个系统中的平均人数
\item 等候队列的平均人数
\item 一单位时间内系统完成服务人数,即服务速度
\end{itemize}

稳定状态下的公式

定义 $\scriptstyle \rho \,=\,{\tfrac  {\lambda }{\mu }}$.
则模型在状态i的机率为
$$ {\mbox{Prob}}(q=i)=\pi _{i}=(1-\rho )\rho ^{i}.\, $$
由此,可给出各测量数值的公式:
整个系统的平均人数N:$\overline N={\frac  {\rho }{1-\rho }}$,
且其变异(variance)为$\sigma _{N}^{2}={\frac  {\rho }{(1-\rho )^{2}}}$.
一单位时间内系统完成服务的人数:$\overline N_{S}=\lambda \overline x=\rho$
在队列中等候服务的人数:$\overline N_{Q}={\frac  {\rho ^{2}}{1-\rho }}$
一人在系统中的平均逗留(等候＋接受服务)时间:$T={\frac  {1}{\mu -\lambda }}$.
一人的平均等候时间:$W={\frac  {\overline N_{Q}}{\lambda }}=T-\overline x=T-{\frac  {1}{\mu }}={\frac  {\rho }{\mu -\lambda }}$

\begin{example}
可用M/M/1模型的例子众多,例如只有一位员工的邮局,只有一队列.客人进来,排队,接受服务,离开.
如果客人进来的数目符合泊松过程,且服务时间是指数分布,则可用M/M/1模拟,并算出平均队列长度,不同等候时间的机率等.

M/M/1可一般化成为M/M/n模型,使可用时接受服务的人数为大于一.
历史上,M/M/n模型首先被用来模拟电话系统,因为荷兰工程师Erlang发现客人打电话的速率符合泊松过程,且通话时间是指数分布,
所以占用通讯线路的数目和等待接线的人数符合M/M/n模型.
\end{example}

\end{document}

